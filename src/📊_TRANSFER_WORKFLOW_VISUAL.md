# ğŸ“Š Transfer Workflow Visual Guide

## Complete Transfer Journey

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SHOPEASY TRANSFER WORKFLOW                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  STATUS: PENDING                                                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸ“‹ Transfer Created                                                       â•‘
â•‘  ğŸ‘¤ Created by: Branch Manager / Admin                                     â•‘
â•‘  ğŸ“¦ Source Stock: UNCHANGED (still available)                              â•‘
â•‘  ğŸ“¦ Destination Stock: UNCHANGED                                           â•‘
â•‘                                                                            â•‘
â•‘  ğŸ”½ AVAILABLE ACTION:                                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â•‘
â•‘  â”‚  [Approve] Button                     â”‚                                â•‘
â•‘  â”‚  Visible to: Destination Manager,     â”‚                                â•‘
â•‘  â”‚              Admin, Owner              â”‚                                â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                    â”‚
                                    â”‚ Click "Approve"
                                    â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  STATUS: APPROVED                                                          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  âœ… Transfer Approved                                                      â•‘
â•‘  ğŸ‘¤ Approved by: Manager / Admin                                           â•‘
â•‘  ğŸ“¤ Source Stock: DECREASED (-quantity) â† INVENTORY CHANGED!               â•‘
â•‘  ğŸ“¦ Destination Stock: UNCHANGED (not yet received)                        â•‘
â•‘                                                                            â•‘
â•‘  ğŸ’¡ Stock is now "in limbo" - deducted but not yet received                â•‘
â•‘                                                                            â•‘
â•‘  ğŸ”½ AVAILABLE ACTION:                                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â•‘
â•‘  â”‚  [In Transit] Button                  â”‚                                â•‘
â•‘  â”‚  Visible to: Admin, Owner             â”‚                                â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                    â”‚
                                    â”‚ Click "In Transit"
                                    â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  STATUS: IN_TRANSIT                                                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸšš Transfer Being Transported                                             â•‘
â•‘  ğŸ‘¤ Marked by: Admin / Owner                                               â•‘
â•‘  ğŸ“¦ Source Stock: DECREASED (already deducted)                             â•‘
â•‘  ğŸ“¦ Destination Stock: UNCHANGED (awaiting delivery)                       â•‘
â•‘                                                                            â•‘
â•‘  ğŸ’¡ Goods are physically being moved between locations                     â•‘
â•‘                                                                            â•‘
â•‘  ğŸ”½ AVAILABLE ACTION:                                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â•‘
â•‘  â”‚  [Accept Transfer] Button             â”‚                                â•‘
â•‘  â”‚  Visible to: Destination Manager,     â”‚                                â•‘
â•‘  â”‚              Admin, Owner              â”‚                                â•‘
â•‘  â”‚  Badge: Green "Ready to Receive"      â”‚                                â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                    â”‚
                                    â”‚ Click "Accept Transfer"
                                    â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  STATUS: COMPLETED âœ…                                                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸ‰ Transfer Completed Successfully                                        â•‘
â•‘  ğŸ‘¤ Received by: Destination Manager                                       â•‘
â•‘  ğŸ“¦ Source Stock: DECREASED (remains reduced)                              â•‘
â•‘  ğŸ“¥ Destination Stock: INCREASED (+quantity) â† INVENTORY CHANGED!          â•‘
â•‘  ğŸ“… Completed at: [timestamp]                                              â•‘
â•‘                                                                            â•‘
â•‘  ğŸ’¡ Stock successfully moved from source to destination                    â•‘
â•‘  ğŸ’¡ Transfer appears in "Completed" section                                â•‘
â•‘  ğŸ’¡ Visible in Recent Activities dashboard                                 â•‘
â•‘                                                                            â•‘
â•‘  âœ¨ NO FURTHER ACTIONS AVAILABLE                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## Inventory Changes Summary

| Status      | Source Branch | Destination Branch | Total System Stock |
|-------------|---------------|--------------------|--------------------|
| PENDING     | 100           | 50                 | 150                |
| APPROVED    | 90 â¬‡ï¸ (-10)   | 50                 | 140 âš ï¸ (in transit)|
| IN_TRANSIT  | 90            | 50                 | 140 (in transit)   |
| COMPLETED   | 90            | 60 â¬†ï¸ (+10)        | 150 âœ…             |

âš ï¸ **Important**: During APPROVED and IN_TRANSIT stages, the total system stock appears reduced because the stock is "in limbo" between locations.

## User Permissions

### Create Transfer
- âœ… Owner
- âœ… Admin
- âŒ Manager (can't create)
- âŒ Cashier (can't create)

### Approve Transfer (Pending â†’ Approved)
- âœ… Owner
- âœ… Admin
- âœ… Destination Branch Manager
- âŒ Source Branch Manager (can't approve their own transfer)

### Mark In Transit (Approved â†’ In Transit)
- âœ… Owner
- âœ… Admin
- âŒ Manager (admin only)

### Accept Transfer (In Transit â†’ Completed)
- âœ… Owner
- âœ… Admin
- âœ… Destination Branch Manager
- âŒ Source Branch Manager

## Button Visibility Matrix

| Transfer Status | Approve | In Transit | Accept |
|----------------|---------|------------|--------|
| PENDING        | âœ… Yes  | âŒ No      | âŒ No  |
| APPROVED       | âŒ No   | âœ… Yes     | âŒ No  |
| IN_TRANSIT     | âŒ No   | âŒ No      | âœ… Yes |
| COMPLETED      | âŒ No   | âŒ No      | âŒ No  |
| REJECTED       | âŒ No   | âŒ No      | âŒ No  |

## Status Badge Colors

- ğŸŸ¡ **PENDING** - Yellow/Warning
- ğŸŸ£ **APPROVED** - Purple
- ğŸ”µ **IN_TRANSIT** - Blue/Info  
- ğŸŸ¢ **COMPLETED** - Green/Success
- ğŸ”´ **REJECTED** - Red/Destructive

## Common Scenarios

### Scenario 1: Standard Transfer (All Steps)
```
Branch A has excess stock â†’ Create transfer â†’ Manager approves
â†’ Admin marks in transit â†’ Branch B receives â†’ âœ… Complete
```

### Scenario 2: Express Transfer (Skip In Transit)
```
Same-building branches â†’ Create transfer â†’ Approve
â†’ Immediately accept (skip in transit) â†’ âœ… Complete
```
Note: System handles this! If you go from APPROVED â†’ COMPLETED, 
it automatically adds to destination.

### Scenario 3: Rejected Transfer
```
Create transfer â†’ Manager reviews â†’ Determines unnecessary
â†’ Reject transfer â†’ âŒ No inventory changes
```

## Database Status Constraint

After running the fix, your database allows these statuses:
```sql
CHECK (status IN (
  'pending',      -- Initial state
  'approved',     -- Approved, source deducted
  'in_transit',   -- Being transported  â† NEWLY ADDED
  'rejected',     -- Cancelled
  'completed'     -- Finished, destination increased
))
```

## Debugging Tips

### Check Transfer Status
```sql
SELECT id, status, quantity, created_at, completed_at
FROM transfers
WHERE organization_id = 'your-org-id'
ORDER BY created_at DESC
LIMIT 10;
```

### Check Inventory Changes
```sql
SELECT 
  i.product_id,
  p.name,
  b.name as branch_name,
  i.quantity,
  i.updated_at
FROM inventory i
JOIN products p ON i.product_id = p.id
JOIN branches b ON i.branch_id = b.id
WHERE i.organization_id = 'your-org-id'
ORDER BY i.updated_at DESC
LIMIT 20;
```

### Console Logs to Look For
```
ğŸ”„ Updating transfer status: ...
ğŸ“¤ [APPROVED] Deducting from source branch: ...
ğŸ“¥ [COMPLETED] Adding to destination branch: ...
âœ… Branch stock adjusted successfully
```
